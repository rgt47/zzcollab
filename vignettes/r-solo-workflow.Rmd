---
title: "R Interface for Solo Development"
author: "ZZCOLLAB Team"
date: "`r Sys.Date()`"
output: 
  rmarkdown::html_vignette:
    toc: true
    toc_depth: 3
vignette: >
  %\VignetteIndexEntry{R Interface for Solo Development}
  %\VignetteEngine{knitr::rmarkdown}
  %\VignetteEncoding{UTF-8}
---

```{r, include = FALSE}
knitr::opts_chunk$set(
  collapse = TRUE,
  comment = "#>",
  eval = FALSE
)
```

# R Interface for Solo Development

This vignette describes ZZCOLLAB's reproducible research capabilities for
R developers using a functional interface that abstracts underlying
containerization technologies.

## Framework Integration for R Users

The framework provides functionality for R developers who require:

- Installing and managing R packages
- Working with R projects and `.Rproj` files
- Using functions and their parameters
- Loading libraries with `library()`

ZZCOLLAB provides containerized reproducibility through a familiar R
functional interface.

**Key characteristics:**

- **Isolated environments** - Project separation and dependency
  isolation
- **Reproducible research** - Consistent computational environments
- **Collaborative compatibility** - Shareable project configurations
- **Abstracted implementation** - Container management through R functions

## Installation and Setup

### One-Time System Setup

```{r eval=FALSE}
# Install the zzcollab R package
# (Instructions for installing from GitHub or source)
library(zzcollab)

# Initialize your configuration (like setting your global R options)
init_config()

# Set your defaults once - then all projects use these settings
set_config("team_name", "myname")        # Your DockerHub username
set_config("github_account", "myname")   # Your GitHub username  
set_config("build_mode", "standard")     # Package installation level
set_config("dotfiles_dir", "~/.dotfiles") # Your configuration files (optional)

# View your configuration
list_config()
```

### Understanding Build Modes

Think of build modes like choosing how many packages to pre-install:

```{r eval=FALSE}
# Fast mode: 9 essential packages (recommended for beginners)
set_config("build_mode", "fast")

# Standard mode: 17 packages including tidyverse (recommended for most users)
set_config("build_mode", "standard")

# Comprehensive mode: 47 packages for complex analyses
set_config("build_mode", "comprehensive")
```

## Creating Your First Project

Creating a reproducible research project is as simple as calling one function:

```{r eval=FALSE}
library(zzcollab)

# Create a new reproducible research project
# This is like usethis::create_project() but with Docker reproducibility
init_project(
  project_name = "penguin-analysis",
  github_account = "myname"  # Creates GitHub repo automatically
)
```

**What this does behind the scenes:**
1. Creates a complete R package structure
2. Sets up Docker environment with your chosen packages
3. Creates GitHub repository with CI/CD workflows
4. Generates all configuration files automatically

## Daily Development Workflow

Once your project is created, your development workflow is purely R-based:

### Starting Your Research Session

```{r eval=FALSE}
# Navigate to your project directory (same as any R project)
setwd("~/projects/penguin-analysis")
# or open penguin-analysis.Rproj in RStudio

# Load the zzcollab package
library(zzcollab)

# Start your reproducible R session
# This launches RStudio Server in your Docker environment
# Access at: http://localhost:8787
start_rstudio()

# Alternative: Start a command-line R session in the container
start_r_session()
```

### Working in Your Reproducible Environment

Your development environment comes pre-loaded with all your packages:

```{r eval=FALSE}
# All your configured packages are already available
library(tidyverse)
library(palmerpenguins)
library(ggplot2)

# Start your analysis - this is regular R code
penguins_clean <- penguins %>%
  filter(!is.na(bill_length_mm), !is.na(bill_depth_mm))

# Create your analysis functions
penguin_plot <- function(data = penguins_clean) {
  data %>%
    ggplot(aes(x = bill_length_mm, y = bill_depth_mm, color = species)) +
    geom_point(size = 2, alpha = 0.7) +
    geom_smooth(method = "lm") +
    labs(
      title = "Penguin Bill Dimensions by Species",
      x = "Bill Length (mm)",
      y = "Bill Depth (mm)"
    ) +
    theme_minimal()
}

# Test your function
plot <- penguin_plot()
print(plot)

# Save your results
ggsave("results/penguin_analysis.png", plot, width = 8, height = 6)
```

### Managing Packages

Adding new packages is as easy as installing them normally:

```{r eval=FALSE}
# Install new packages (these get tracked automatically)
install.packages("broom")
library(broom)

# Your environment automatically tracks what you install
# Check which packages are being tracked
sync_env()  # This updates your package lockfile

# Validate your environment is reproducible
validate_repro()  # Checks that all dependencies are properly recorded
```

### Running Your Analysis Scripts

```{r eval=FALSE}
# Run analysis scripts in the reproducible environment
run_script("scripts/01_data_cleaning.R")
run_script("scripts/02_analysis.R")
run_script("scripts/03_visualization.R")

# Render reports (R Markdown/Quarto documents)
render_report("analysis/penguin_report.Rmd")
render_report("reports/final_analysis.qmd")
```

### Version Control Integration

ZZCOLLAB integrates with Git through R functions:

```{r eval=FALSE}
# Check what has changed (like git status)
git_status()

# Commit your changes with meaningful messages
git_commit("Add initial penguin bill analysis

- Create penguin_plot() function for bill dimensions
- Add data cleaning pipeline
- Generate publication-quality figures
- All tests passing")

# Push to GitHub
git_push()

# Create feature branches for new analysis
create_branch("bill-depth-analysis")

# Create pull request when ready
create_pr(
  title = "Add bill depth analysis", 
  body = "This analysis explores the relationship between bill depth and species"
)
```

## Working Example: Complete Penguin Analysis

Here's a complete example showing the R-only workflow:

### Project Setup

```{r eval=FALSE}
library(zzcollab)

# One-time project creation
init_project(
  project_name = "penguin-research",
  build_mode = "standard"  # Includes tidyverse, palmerpenguins, etc.
)

# Start your development environment
setwd("penguin-research")
start_rstudio()  # Opens RStudio at localhost:8787
```

### Analysis Development (in RStudio or R console)

```{r eval=FALSE}
# This code runs in your reproducible Docker environment
library(tidyverse)
library(palmerpenguins) 
library(broom)

# Create analysis functions
analyze_penguin_bills <- function(data = penguins) {
  # Clean data
  clean_data <- data %>%
    filter(!is.na(bill_length_mm), !is.na(bill_depth_mm), !is.na(species))
  
  # Fit model
  model <- lm(bill_depth_mm ~ bill_length_mm * species, data = clean_data)
  
  # Create visualization
  plot <- clean_data %>%
    ggplot(aes(x = bill_length_mm, y = bill_depth_mm, color = species)) +
    geom_point(size = 2, alpha = 0.7) +
    geom_smooth(method = "lm", se = TRUE) +
    facet_wrap(~ species) +
    labs(
      title = "Bill Depth vs Length by Penguin Species",
      x = "Bill Length (mm)",
      y = "Bill Depth (mm)",
      color = "Species"
    ) +
    theme_minimal() +
    theme(legend.position = "none")
  
  # Return results
  list(
    model = model,
    model_summary = tidy(model),
    plot = plot,
    r_squared = glance(model)$r.squared
  )
}

# Run analysis
results <- analyze_penguin_bills()

# View results
print(results$model_summary)
print(paste("R-squared:", round(results$r_squared, 3)))
print(results$plot)

# Save outputs
ggsave("figures/penguin_bill_analysis.png", results$plot, 
       width = 10, height = 6, dpi = 300)
saveRDS(results, "data/analysis_results.rds")

# Write your analysis to a script file
# save this code to scripts/penguin_analysis.R
```

### Project Management and Sharing

```{r eval=FALSE}
# Back in your regular R session (outside the container)
library(zzcollab)

# Check project status
status()  # Shows running containers

# Validate everything is reproducible
validate_repro()  # Checks dependencies, scripts, etc.

# Commit your work
git_commit("Complete penguin bill analysis

- Implement analyze_penguin_bills() function
- Add species-specific linear models  
- Generate faceted visualization
- Save results for reproducibility
- R-squared: 0.85 for species-specific relationships")

git_push()

# Your project is now fully reproducible and ready to share!
```

## Understanding What Happens Behind the Scenes

For R users interested in the underlying implementation:

```{r eval=FALSE}
# These R functions handle Docker automatically:

start_rstudio()
# = Equivalent to: docker run -p 8787:8787 your-project-image rstudio-server

run_script("analysis.R")  
# = Equivalent to: docker run your-project-image Rscript analysis.R

validate_repro()
# = Checks Docker environment, package versions, script dependencies

sync_env()
# = Updates package lockfile (renv.lock) with current environment

git_commit("message")
# = Regular git commands, but ensures reproducible environment is committed
```

## Key Advantages for R Users

### 1. Familiar R Interface

```{r eval=FALSE}
# Everything feels like regular R development
library(zzcollab)
init_project("my-analysis")    # Like usethis::create_project()
start_rstudio()                # Like opening RStudio normally
git_commit("Add analysis")     # Like using Git in RStudio
```

### 2. Automatic Package Management

```{r eval=FALSE}
# No need to manage Docker images or containers
install.packages("new_package")  # Just install packages normally
sync_env()                       # ZZCOLLAB handles the reproducibility
```

### 3. Team Collaboration

```{r eval=FALSE}
# Share projects with complete reproducibility
# Your collaborators get identical environments with one function call
# They just need to run:
join_project(team_name = "yourname", project_name = "penguin-research")
```

### 4. Built-in Best Practices

```{r eval=FALSE}
# ZZCOLLAB automatically provides:
validate_repro()  # Dependency checking
status()          # Environment monitoring  
git_*()           # Version control integration
render_report()   # Report generation
```

## Common Workflows

### Starting a New Analysis

```{r eval=FALSE}
library(zzcollab)
init_project("customer-segmentation", build_mode = "comprehensive")
setwd("customer-segmentation")
start_rstudio()
# Begin coding in familiar RStudio environment
```

### Daily Development

```{r eval=FALSE}
setwd("customer-segmentation")
start_rstudio()              # Continue where you left off
# ... do your analysis work ...
validate_repro()             # Check reproducibility
git_commit("Add clustering")
git_push()
```

### Sharing with Colleagues

```{r eval=FALSE}
# Your colleague (who also has zzcollab) runs:
join_project("yourname", "customer-segmentation")
start_rstudio()  # They get your exact environment
```

## Troubleshooting

### Common Issues and Solutions

```{r eval=FALSE}
# Issue: RStudio won't start
status()  # Check if containers are running
rebuild()  # Rebuild if needed

# Issue: Packages missing
sync_env()      # Update package tracking
validate_repro()  # Check for issues

# Issue: Git problems
git_status()  # Check repository state

# Issue: Environment problems
# Stop all containers and restart
stop_containers()
start_rstudio()
```

### Getting Help

```{r eval=FALSE}
# Built-in help system
zzcollab_help()           # General help
zzcollab_help(init = TRUE)  # Project initialization help
zzcollab_next_steps()     # What to do next
```

## Summary

ZZCOLLAB provides containerized reproducibility through an R-native interface:

**R-native interface** - Functions integrate with existing R workflows  
**Abstracted complexity** - Container management handled programmatically  
**Standard development** - Compatible with RStudio, R scripts, and package ecosystem  
**Automated reproducibility** - Consistent environments through systematic configuration  
**Collaborative workflows** - Standardized environment sharing mechanisms  
**Version control integration** - Git workflows accessible through R functions  

Start your next reproducible research project with just:

```{r eval=FALSE}
library(zzcollab)
init_project("my-research")
start_rstudio()
# Begin your analysis!
```

This approach provides systematic reproducibility and collaborative compatibility through standard R programming interfaces.