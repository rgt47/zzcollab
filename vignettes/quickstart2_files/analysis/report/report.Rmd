---
title: "Fuel Efficiency Analysis: mtcars Subset"
author: "Developer 1"
date: "`r Sys.Date()`"
output:
  html_document:
    toc: true
    toc_float: true
    theme: flatly
bibliography: references.bib
---

```{r report-setup, include=FALSE}
knitr::opts_chunk$set(
  echo = TRUE,
  message = FALSE,
  warning = FALSE,
  fig.width = 8,
  fig.height = 5
)

# Load package functions from R/ directory
devtools::load_all(here::here())
```

## Introduction

This analysis examines fuel efficiency patterns in a subset of the Motor
Trend Car Road Tests dataset. The raw data contains all 32 observations;
the derived dataset extracts the first 16 observations for analysis.

## Data Loading

```{r load-data}
library(dplyr)
library(ggplot2)
library(knitr)

# Load processed data
data <- readRDS(here::here("analysis/data/derived_data/mtcars_processed.rds"))

# Display summary
kable(head(data), caption = "First observations of processed data")
```

## Summary Statistics

```{r summary-stats}
summary_stats <- data |>
  group_by(efficiency_class) |>
  summarise(
    n = n(),
    mean_mpg = mean(mpg),
    mean_hp = mean(hp),
    mean_weight_kg = mean(weight_kg),
    .groups = "drop"
  )

kable(summary_stats,
      digits = 2,
      caption = "Summary statistics by efficiency class")
```

## Analysis Results

### Fuel Efficiency Distribution

```{r mpg-histogram}
ggplot(data, aes(x = mpg, fill = efficiency_class)) +
  geom_histogram(bins = 8, alpha = 0.7, color = "white") +
  labs(
    title = "Distribution of Fuel Efficiency",
    x = "Miles Per Gallon",
    y = "Count",
    fill = "Efficiency Class"
  ) +
  theme_minimal()
```

### Power vs Weight Analysis

```{r power-weight-plot}
# Functions loaded via devtools::load_all() in setup chunk
plot_power_weight(data, show_labels = TRUE)
```

This scatter plot reveals the relationship between engine power and vehicle
weight. Higher efficiency vehicles (green) cluster in the lower-left region,
indicating lower weight and moderate horsepower.

### Cylinder Comparison

```{r cylinder-boxplot}
plot_mpg_by_cylinder(data)
```

The boxplot demonstrates the expected inverse relationship between cylinder
count and fuel efficiency. Four-cylinder vehicles show the highest MPG values,
while eight-cylinder vehicles demonstrate lower fuel efficiency.

## Conclusions

This analysis of the mtcars subset reveals several key findings:

1. **Efficiency Classification**: The dataset contains a mix of low, medium,
   and high efficiency vehicles based on the 15 and 20 MPG thresholds.

2. **Weight-Power Relationship**: There is a clear positive correlation
   between vehicle weight and horsepower, with efficiency class serving as
   a useful categorization.

3. **Cylinder Effect**: Vehicles with fewer cylinders consistently achieve
   better fuel economy, supporting the expected engineering trade-off between
   power and efficiency.

## Session Information

```{r session-info}
sessionInfo()
```

## References
