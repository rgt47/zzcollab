---
title: "Solo Manuscript Workflow Guide"
author: "ZZCOLLAB Team"
date: "`r Sys.Date()`"
output:
  rmarkdown::html_vignette:
    toc: true
    toc_depth: 3
vignette: >
  %\VignetteIndexEntry{Solo Manuscript Workflow Guide}
  %\VignetteEngine{knitr::rmarkdown}
  %\VignetteEncoding{UTF-8}
---

```{r, include = FALSE}
knitr::opts_chunk$set(
  collapse = TRUE,
  comment = "#>",
  eval = FALSE
)
```

# ZZCOLLAB Solo Manuscript Workflow Guide

This vignette describes the implementation of reproducible manuscript preparation workflows for academic researchers using the ZZCOLLAB framework with the manuscript paradigm.

## Overview: Manuscript Paradigm

The **manuscript paradigm** implements a complete research compendium that supports full development of both computational analysis (R functions) and academic narrative (manuscript writing):

- **Primary goal**: Transform analysis into published papers through integrated R package and manuscript development
- **Architecture**: Full R package structure + manuscript infrastructure
- **Structure**: `R/`, `tests/testthat/`, `man/`, `manuscript/`, `analysis/reproduce/`, `submission/`, `DESCRIPTION`, `NAMESPACE`
- **Tools**: devtools, roxygen2, testthat, rmarkdown, bookdown, papaja, RefManageR
- **Workflow**: Function Development â†” Manuscript Writing â†” Testing â†” Documentation â†” Submission
- **Development**: Supports iterative modification of both R code and manuscript content
- **Collaboration**: Teams can work on R functions and manuscript simultaneously
- **Best for**: Academic researchers developing methods and writing papers, graduate students creating reproducible thesis research

## Initial Setup (One-Time)

### 1. Install ZZCOLLAB System

```bash
# Clone and install zzcollab
git clone https://github.com/rgt47/zzcollab.git
cd zzcollab && ./install.sh

# Verify installation
zzcollab --help && which zzcollab
```

### 2. Configuration for Manuscript Writing

ZZCOLLAB configuration optimized for academic manuscript preparation:

```bash
# Initialize configuration file
zzcollab --config init

# Set manuscript-specific defaults
zzcollab --config set team-name "rgt47"              # Your Docker Hub account
zzcollab --config set github-account "rgt47"        # Your GitHub username
zzcollab --config set paradigm "manuscript"         # Key: manuscript paradigm
zzcollab --config set build-mode "standard"         # standard includes publishing tools
zzcollab --config set dotfiles-dir "~/dotfiles"     # Path to your dotfiles

# View your configuration
zzcollab --config list
```

## Project Creation for Manuscript Writing

### Standard Manuscript Project Setup

```bash
# Create manuscript project with publishing tools
zzcollab -i -p research-paper --paradigm manuscript --github

# This creates the manuscript-optimized directory structure:
# R/                    # Functions for analysis and data processing
# tests/testthat/       # Unit tests for your functions
# manuscript/           # Main manuscript files
# analysis/reproduce/   # Scripts to reproduce all results
# submission/           # Files prepared for journal submission
# data/                 # Data files with automated documentation
```

### Advanced Publishing Environment Setup

```bash
# For complex manuscripts requiring specialized environments
mkdir research-paper && cd research-paper
zzcollab -i -p research-paper --paradigm manuscript
./add_variant.sh                     # Browse comprehensive variant library

# Recommended variants for manuscript writing:
# ğŸ“¦ STANDARD RESEARCH ENVIRONMENTS
#  1) minimal          ~800MB  - Essential R packages (testing/CI)
#  2) analysis         ~1.2GB  - Tidyverse + data analysis tools
#  4) publishing       ~3GB    - LaTeX, Quarto, bookdown, papaja
#  5) shiny            ~1.8GB  - Interactive supplementary materials
#
# ğŸ”¬ SPECIALIZED DOMAINS (if applicable)
#  7) bioinformatics   ~2GB    - Bioconductor (life sciences papers)
#  8) geospatial       ~2.5GB  - Spatial analysis (geography/ecology papers)
#
# ğŸ”ï¸ LIGHTWEIGHT ALPINE VARIANTS
#  9) alpine_minimal   ~200MB  # CI/CD for manuscript validation

# Select publishing + minimal variants, then:
zzcollab --variants-config config.yaml --github
```

### Complete Research Compendium Structure

The manuscript paradigm creates a complete research compendium with full R package infrastructure:

```
research-paper/
â”œâ”€â”€ DESCRIPTION                 # Package metadata & dependencies (REQUIRED)
â”œâ”€â”€ NAMESPACE                   # Exported functions (REQUIRED)
â”œâ”€â”€ .Rbuildignore              # Exclude manuscript files from package build
â”œâ”€â”€ R/                          # Analysis functions (EDITABLE)
â”‚   â”œâ”€â”€ data_processing.R       # Data cleaning and preparation functions
â”‚   â”œâ”€â”€ statistical_analysis.R  # Statistical models and tests
â”‚   â”œâ”€â”€ visualization.R         # Publication-ready figure functions
â”‚   â””â”€â”€ manuscript_utils.R      # Manuscript-specific utilities
â”œâ”€â”€ man/                        # Generated function documentation
â”‚   â”œâ”€â”€ prepare_penguin_data.Rd
â”‚   â”œâ”€â”€ analyze_species_differences.Rd
â”‚   â””â”€â”€ create_species_plot.Rd
â”œâ”€â”€ tests/testthat/             # Function tests (EDITABLE)
â”‚   â”œâ”€â”€ test-data_processing.R
â”‚   â”œâ”€â”€ test-statistical_analysis.R
â”‚   â”œâ”€â”€ test-visualization.R
â”‚   â””â”€â”€ test-manuscript_utils.R
â”œâ”€â”€ manuscript/                 # Academic writing infrastructure (EDITABLE)
â”‚   â”œâ”€â”€ paper.Rmd              # Main manuscript (papaja format)
â”‚   â”œâ”€â”€ supplementary.Rmd      # Supplementary materials
â”‚   â”œâ”€â”€ references.bib         # Bibliography
â”‚   â””â”€â”€ journal_templates/     # Journal-specific formatting
â”œâ”€â”€ analysis/reproduce/         # Reproducibility scripts (EDITABLE)
â”‚   â”œâ”€â”€ 01_data_preparation.R   # Data processing workflow
â”‚   â”œâ”€â”€ 02_statistical_analysis.R # Statistical analysis pipeline
â”‚   â”œâ”€â”€ 03_figures_tables.R     # Generate all manuscript outputs
â”‚   â””â”€â”€ 04_manuscript_render.R  # Render all manuscript formats
â”œâ”€â”€ submission/                 # Journal submission package
â”‚   â”œâ”€â”€ figures/               # High-resolution figures
â”‚   â”œâ”€â”€ tables/                # Publication-ready tables
â”‚   â”œâ”€â”€ supplementary/         # Supplementary files
â”‚   â””â”€â”€ manuscript_versions/   # Journal-specific formats
â”œâ”€â”€ data/                      # Data management
â”‚   â”œâ”€â”€ raw_data/              # Original, immutable data files
â”‚   â”œâ”€â”€ derived_data/          # Processed, analysis-ready data
â”‚   â””â”€â”€ README.md              # Comprehensive data documentation
â”œâ”€â”€ vignettes/                 # Package vignettes (optional)
â”‚   â””â”€â”€ analysis_methods.Rmd  # Methodological documentation
â”œâ”€â”€ inst/                      # Package installation files
â”‚   â””â”€â”€ examples/              # Reproducible examples
â”œâ”€â”€ renv.lock                  # Environment snapshot
â””â”€â”€ .github/workflows/         # Automated validation
    â”œâ”€â”€ R-CMD-check.yaml       # R package validation
    â””â”€â”€ render-manuscript.yaml # Manuscript compilation
```

## Daily Manuscript Development Workflow

### 1. Start Development Environment

```bash
cd research-paper

# Choose interface based on your variants:
make docker-zsh         # Shell interface (works with any variant)
make docker-rstudio     # RStudio Server at localhost:8787 (recommended for writing)
make docker-verse       # Publishing workflow with LaTeX (if publishing variant)
```

### 2. Manuscript Development Cycle

**Working inside the container:**

```bash
# You're now inside the Docker container with all publishing tools pre-installed
# Your project directory is mounted at /home/analyst/project

# Manuscript writing workflow
vim manuscript/paper.Rmd          # Write/edit main manuscript
vim manuscript/references.bib     # Manage bibliography

# Analysis function development
vim R/data_processing.R           # Create data processing functions
vim R/statistical_analysis.R     # Statistical analysis functions
vim R/visualization.R             # Figure generation functions

# Write tests for your functions
vim tests/testthat/test-data_processing.R     # Test data functions
vim tests/testthat/test-statistical_analysis.R # Test analysis functions
vim tests/testthat/test-visualization.R       # Test visualization functions

# Create reproducibility scripts
vim analysis/reproduce/01_data_preparation.R    # Data processing workflow
vim analysis/reproduce/02_statistical_analysis.R # Statistical analysis
vim analysis/reproduce/03_figures_tables.R      # Generate all outputs

# Test your functions
R
devtools::load_all()              # Load your package functions
devtools::test()                  # Run all tests
quit()

# Render manuscript components
R
rmarkdown::render("manuscript/paper.Rmd")              # Compile manuscript
rmarkdown::render("manuscript/supplementary.Rmd")     # Compile supplements
quit()

# Run reproducibility scripts
R --vanilla < analysis/reproduce/01_data_preparation.R
R --vanilla < analysis/reproduce/02_statistical_analysis.R
R --vanilla < analysis/reproduce/03_figures_tables.R

# Check git status
git status
git add .
git diff --cached
```

### 3. Exit Container and Commit

```bash
# Exit the development container
exit

# Validate reproducibility and dependencies
make docker-check-renv-fix    # Auto-fix any dependency issues
make docker-test             # Run all function tests in clean environment
make docker-render           # Ensure manuscript renders correctly

# Git workflow - commit manuscript progress
git status                   # Check what changed
git diff                    # Review changes

git add .
git commit -m "Add statistical analysis section

- Implement mixed-effects models for treatment comparison
- Add model validation functions with comprehensive tests
- Generate publication-ready figures with error bars
- Update manuscript with statistical methods section
- All tests passing, reproducibility scripts validated"

git push origin main        # Push to GitHub
```

### 4. Automated Manuscript Validation

When you push changes to GitHub:

1. **GitHub Actions automatically**:
   - âœ… Renders complete manuscript (paper.Rmd â†’ PDF)
   - âœ… Runs all function tests
   - âœ… Executes reproducibility scripts
   - âœ… Generates all figures and tables
   - âœ… Validates bibliography and citations

2. **If manuscript compilation fails**:
   - âŒ Build log shows specific LaTeX/rendering errors
   - âŒ Email notification with error details
   - âœ… Fix errors and push again for re-validation

## Advanced Manuscript Patterns

### Working with Publishing Variants

```bash
# Use different environments for different manuscript tasks
make docker-rstudio          # Interactive writing and analysis
make docker-verse            # LaTeX compilation and advanced formatting
make docker-zsh              # Command-line text processing and git workflow

# Each environment optimized for manuscript preparation tasks
```

### Manuscript Validation Workflow

```bash
# Before submitting to journals, validate complete workflow:
make docker-test             # Run all function tests
make docker-render           # Render manuscript and supplements
make docker-check            # R package validation (for reusable functions)

# Run complete reproducibility check
make docker-zsh
R --vanilla < analysis/reproduce/01_data_preparation.R
R --vanilla < analysis/reproduce/02_statistical_analysis.R
R --vanilla < analysis/reproduce/03_figures_tables.R
exit

# Ensure all outputs match manuscript content
```

### Collaborative Function Development

```bash
# Inside container - develop reusable analysis functions
R
devtools::check()            # Full package validation
usethis::use_test("my_statistical_function")  # Create test file
devtools::document()         # Generate function documentation
quit()

# Document all functions with roxygen2
make docker-document         # Generate comprehensive documentation
make docker-check           # Validate R package structure
```

## Practical Example: Penguin Species Comparison Manuscript

Let's walk through a complete manuscript workflow using Palmer penguins data to demonstrate academic writing with ZZCOLLAB.

### Step 1: Create Manuscript Project and Functions

```bash
# Set up the manuscript project
zzcollab -i -p penguin-manuscript --paradigm manuscript --github

# Start development environment
cd penguin-manuscript
make docker-rstudio    # Use RStudio for manuscript writing
```

**Inside the container - Set up R package infrastructure:**

```bash
# First, create the DESCRIPTION file (required for R package structure)
vim DESCRIPTION
```

**Contents of `DESCRIPTION`:**

```yaml
Package: penguinanalysis
Type: Package
Title: Palmer Penguin Species Comparison Analysis
Version: 0.1.0
Author: Your Name <your.email@institution.edu>
Maintainer: Your Name <your.email@institution.edu>
Description: Statistical analysis and visualization functions for comparing
    morphological differences among Palmer penguin species. This research
    compendium contains functions for data processing, statistical analysis,
    and publication-ready visualization supporting the manuscript
    "Morphological Differentiation Among Palmer Penguin Species".
License: MIT + file LICENSE
Encoding: UTF-8
LazyData: true
Roxygen: list(markdown = TRUE)
RoxygenNote: 7.2.3
Depends:
    R (>= 4.0.0)
Imports:
    dplyr,
    ggplot2,
    broom,
    emmeans,
    palmerpenguins
Suggests:
    testthat (>= 3.0.0),
    rmarkdown,
    knitr,
    papaja,
    corrplot,
    stringr
VignetteBuilder: knitr
```

```bash
# Create the NAMESPACE file (required for exported functions)
vim NAMESPACE
```

**Contents of `NAMESPACE`:**

```r
# Generated by roxygen2: do not edit by hand

export(analyze_species_differences)
export(create_correlation_plot)
export(create_species_plot)
export(format_anova_table)
export(prepare_penguin_data)
export(summarize_by_species)
importFrom(dplyr,"%>%")
importFrom(dplyr,count)
importFrom(dplyr,filter)
importFrom(dplyr,group_by)
importFrom(dplyr,mutate)
importFrom(dplyr,n)
importFrom(dplyr,select)
importFrom(dplyr,summarise)
importFrom(ggplot2,aes)
importFrom(ggplot2,aes_string)
importFrom(ggplot2,element_text)
importFrom(ggplot2,geom_boxplot)
importFrom(ggplot2,geom_jitter)
importFrom(ggplot2,ggplot)
importFrom(ggplot2,labs)
importFrom(ggplot2,scale_color_manual)
importFrom(ggplot2,scale_fill_manual)
importFrom(ggplot2,theme)
importFrom(ggplot2,theme_classic)
```

```bash
# Create .Rbuildignore to exclude manuscript files from package build
vim .Rbuildignore
```

**Contents of `.Rbuildignore`:**

```
^.*\.Rproj$
^\.Rproj\.user$
^manuscript$
^analysis$
^submission$
^\.github$
^data/raw_data$
^\.git$
^\.gitignore$
^README\.md$
```

**Now create analysis functions:**

```bash
# Create data processing function
vim R/data_processing.R
```

**Contents of `R/data_processing.R`:**

```r
#' Prepare penguin data for statistical analysis
#'
#' Cleans Palmer penguins data by removing missing values and creating
#' derived variables for species comparison analysis.
#'
#' @param data Penguin data frame (default: palmerpenguins::penguins)
#' @param min_sample_size Minimum sample size per species (default: 10)
#' @return Cleaned data frame with derived variables
#' @export
#' @examples
#' clean_data <- prepare_penguin_data()
#' head(clean_data)
prepare_penguin_data <- function(data = palmerpenguins::penguins,
                                min_sample_size = 10) {

  if (!requireNamespace("dplyr", quietly = TRUE)) {
    stop("dplyr package is required")
  }

  # Clean data and create derived variables
  cleaned_data <- data %>%
    dplyr::filter(
      !is.na(bill_length_mm),
      !is.na(bill_depth_mm),
      !is.na(flipper_length_mm),
      !is.na(body_mass_g),
      !is.na(sex),
      !is.na(species)
    ) %>%
    dplyr::mutate(
      # Create standardized measurements (z-scores)
      bill_length_std = scale(bill_length_mm)[,1],
      bill_depth_std = scale(bill_depth_mm)[,1],
      flipper_length_std = scale(flipper_length_mm)[,1],
      body_mass_std = scale(body_mass_g)[,1],

      # Create bill ratio (length/depth)
      bill_ratio = bill_length_mm / bill_depth_mm,

      # Body condition index (mass/flipper length)
      body_condition = body_mass_g / flipper_length_mm,

      # Factor variables
      species = as.factor(species),
      sex = as.factor(sex),
      island = as.factor(island)
    )

  # Remove species with insufficient sample sizes
  species_counts <- cleaned_data %>%
    dplyr::count(species) %>%
    dplyr::filter(n >= min_sample_size)

  result <- cleaned_data %>%
    dplyr::filter(species %in% species_counts$species)

  # Add metadata attributes
  attr(result, "sample_sizes") <- table(result$species)
  attr(result, "preparation_date") <- Sys.Date()

  return(result)
}

#' Get summary statistics by species
#'
#' @param data Prepared penguin data frame
#' @return Data frame with summary statistics
#' @export
summarize_by_species <- function(data) {
  data %>%
    dplyr::group_by(species) %>%
    dplyr::summarise(
      n = dplyr::n(),
      bill_length_mean = mean(bill_length_mm, na.rm = TRUE),
      bill_length_sd = sd(bill_length_mm, na.rm = TRUE),
      bill_depth_mean = mean(bill_depth_mm, na.rm = TRUE),
      bill_depth_sd = sd(bill_depth_mm, na.rm = TRUE),
      body_mass_mean = mean(body_mass_g, na.rm = TRUE),
      body_mass_sd = sd(body_mass_g, na.rm = TRUE),
      .groups = "drop"
    )
}
```

**Create statistical analysis functions:**

```bash
vim R/statistical_analysis.R
```

**Contents of `R/statistical_analysis.R`:**

```r
#' Perform ANOVA comparing penguin species
#'
#' @param data Prepared penguin data frame
#' @param response_var Name of response variable
#' @return List containing ANOVA results and post-hoc tests
#' @export
analyze_species_differences <- function(data, response_var) {

  if (!requireNamespace("broom", quietly = TRUE)) {
    stop("broom package is required")
  }
  if (!requireNamespace("emmeans", quietly = TRUE)) {
    stop("emmeans package is required")
  }

  # Fit ANOVA model
  formula_str <- paste(response_var, "~ species")
  model <- aov(as.formula(formula_str), data = data)

  # ANOVA table
  anova_results <- broom::tidy(model)

  # Post-hoc comparisons
  emmeans_obj <- emmeans::emmeans(model, ~ species)
  pairwise <- emmeans::pairs(emmeans_obj, adjust = "tukey")

  # Effect sizes
  eta_squared <- anova_results$sumsq[1] / sum(anova_results$sumsq)

  list(
    model = model,
    anova_table = anova_results,
    posthoc_comparisons = broom::tidy(pairwise),
    eta_squared = eta_squared,
    sample_size = nrow(data)
  )
}

#' Create publication-ready ANOVA table
#'
#' @param anova_result Result from analyze_species_differences()
#' @return Formatted table suitable for manuscript
#' @export
format_anova_table <- function(anova_result) {
  anova_result$anova_table %>%
    dplyr::mutate(
      df = df,
      `Sum Sq` = round(sumsq, 2),
      `Mean Sq` = round(meansq, 2),
      `F value` = round(statistic, 2),
      `Pr(>F)` = ifelse(p.value < 0.001, "< 0.001",
                       sprintf("%.3f", p.value))
    ) %>%
    dplyr::select(term, df, `Sum Sq`, `Mean Sq`, `F value`, `Pr(>F)`)
}
```

**Create visualization functions:**

```bash
vim R/visualization.R
```

**Contents of `R/visualization.R`:**

```r
#' Create publication-ready species comparison plot
#'
#' @param data Prepared penguin data frame
#' @param x_var X-axis variable name
#' @param y_var Y-axis variable name
#' @param title Plot title
#' @return ggplot object
#' @export
create_species_plot <- function(data, x_var, y_var, title = "") {

  if (!requireNamespace("ggplot2", quietly = TRUE)) {
    stop("ggplot2 package is required")
  }

  ggplot2::ggplot(data, ggplot2::aes_string(x = x_var, y = y_var)) +
    ggplot2::geom_boxplot(ggplot2::aes(fill = species), alpha = 0.7) +
    ggplot2::geom_jitter(ggplot2::aes(color = species),
                        width = 0.2, alpha = 0.5) +
    ggplot2::scale_fill_manual(
      values = c("Adelie" = "#FF6B6B",
                "Chinstrap" = "#4ECDC4",
                "Gentoo" = "#45B7D1")
    ) +
    ggplot2::scale_color_manual(
      values = c("Adelie" = "#FF6B6B",
                "Chinstrap" = "#4ECDC4",
                "Gentoo" = "#45B7D1")
    ) +
    ggplot2::labs(
      title = title,
      x = gsub("_", " ", stringr::str_to_title(x_var)),
      y = gsub("_", " ", stringr::str_to_title(y_var)),
      fill = "Species",
      color = "Species"
    ) +
    ggplot2::theme_classic() +
    ggplot2::theme(
      plot.title = ggplot2::element_text(hjust = 0.5, size = 12, face = "bold"),
      legend.position = "bottom",
      axis.text = ggplot2::element_text(size = 10),
      axis.title = ggplot2::element_text(size = 11)
    )
}

#' Create correlation matrix plot for manuscript
#'
#' @param data Prepared penguin data frame
#' @return ggplot correlation matrix
#' @export
create_correlation_plot <- function(data) {

  if (!requireNamespace("corrplot", quietly = TRUE)) {
    stop("corrplot package is required")
  }

  # Select numeric variables
  numeric_vars <- data %>%
    dplyr::select(bill_length_mm, bill_depth_mm,
                 flipper_length_mm, body_mass_g) %>%
    as.matrix()

  # Calculate correlation matrix
  cor_matrix <- cor(numeric_vars, use = "complete.obs")

  # Create correlation plot
  corrplot::corrplot(cor_matrix, method = "color", type = "upper",
                    order = "hclust", tl.cex = 0.8, tl.col = "black")
}
```

**Create comprehensive tests:**

```bash
vim tests/testthat/test-data_processing.R
```

**Contents of `tests/testthat/test-data_processing.R`:**

```r
test_that("prepare_penguin_data works correctly", {
  # Test with default data
  clean_data <- prepare_penguin_data()

  # Check structure
  expect_s3_class(clean_data, "data.frame")
  expect_true(nrow(clean_data) > 0)

  # Check that all required columns exist
  required_cols <- c("species", "bill_length_mm", "bill_depth_mm",
                    "flipper_length_mm", "body_mass_g", "sex")
  expect_true(all(required_cols %in% names(clean_data)))

  # Check derived variables
  expect_true("bill_ratio" %in% names(clean_data))
  expect_true("body_condition" %in% names(clean_data))
  expect_true("bill_length_std" %in% names(clean_data))

  # Check no missing values in key variables
  expect_true(all(!is.na(clean_data$bill_length_mm)))
  expect_true(all(!is.na(clean_data$species)))

  # Check attributes
  expect_true(!is.null(attr(clean_data, "sample_sizes")))
  expect_true(!is.null(attr(clean_data, "preparation_date")))
})

test_that("summarize_by_species produces correct output", {
  test_data <- data.frame(
    species = factor(rep(c("A", "B"), each = 5)),
    bill_length_mm = c(rep(40, 5), rep(50, 5)),
    bill_depth_mm = c(rep(15, 5), rep(18, 5)),
    body_mass_g = c(rep(3000, 5), rep(4000, 5))
  )

  summary_stats <- summarize_by_species(test_data)

  expect_s3_class(summary_stats, "data.frame")
  expect_equal(nrow(summary_stats), 2)
  expect_true("n" %in% names(summary_stats))
  expect_true("bill_length_mean" %in% names(summary_stats))

  # Check calculated means
  expect_equal(summary_stats$bill_length_mean[1], 40)
  expect_equal(summary_stats$bill_length_mean[2], 50)
})
```

**Create the main manuscript file:**

```bash
vim manuscript/paper.Rmd
```

**Contents of `manuscript/paper.Rmd` (papaja format):**

```r
---
title: "Morphological Differentiation Among Palmer Penguin Species: A Comparative Analysis"
shorttitle: "Palmer Penguin Species Comparison"
author:
  - name: Your Name
    affiliation: 1
    corresponding: yes
    address: Your Institution
    email: your.email@institution.edu

affiliation:
  - id: 1
    institution: Your Institution

abstract: |
  We examined morphological differences among three penguin species (Adelie, Chinstrap, and Gentoo) using the Palmer penguins dataset. Our analysis focused on bill dimensions, flipper length, and body mass measurements. Results revealed significant species differences across all morphological traits (all p < 0.001), with effect sizes ranging from moderate to large. These findings support distinct ecological niches and evolutionary adaptations among Palmer penguin species.

keywords: "penguins, morphology, species differences, Antarctic ecology"
wordcount: "1,247"

bibliography: references.bib
floatsintext: yes
figurelist: yes
tablelist: yes
footnotelist: no
linenumbers: no
mask: no

class: man
output: papaja::apa6_pdf
---

```{r setup, include = FALSE}
library("papaja")
library("palmerpenguins")
library("dplyr")
library("ggplot2")
library("broom")
library("emmeans")

# Set up figure and table output
r_refs("../references.bib")

# Preload sample size data for inline references
penguins_clean <- palmerpenguins::penguins %>%
  filter(!is.na(bill_length_mm), !is.na(bill_depth_mm),
         !is.na(flipper_length_mm), !is.na(body_mass_g),
         !is.na(sex), !is.na(species))

sample_counts <- table(penguins_clean$species)
```

```{r define-functions, include = FALSE}
# Define the analysis functions

#' Prepare penguin data for statistical analysis
prepare_penguin_data <- function(data = palmerpenguins::penguins,
                                min_sample_size = 10) {

  if (!requireNamespace("dplyr", quietly = TRUE)) {
    stop("dplyr package is required")
  }

  # Clean data and create derived variables
  cleaned_data <- data %>%
    dplyr::filter(
      !is.na(bill_length_mm),
      !is.na(bill_depth_mm),
      !is.na(flipper_length_mm),
      !is.na(body_mass_g),
      !is.na(sex),
      !is.na(species)
    ) %>%
    dplyr::mutate(
      # Create standardized measurements (z-scores)
      bill_length_std = scale(bill_length_mm)[,1],
      bill_depth_std = scale(bill_depth_mm)[,1],
      flipper_length_std = scale(flipper_length_mm)[,1],
      body_mass_std = scale(body_mass_g)[,1],

      # Create bill ratio (length/depth)
      bill_ratio = bill_length_mm / bill_depth_mm,

      # Body condition index (mass/flipper length)
      body_condition = body_mass_g / flipper_length_mm,

      # Factor variables
      species = as.factor(species),
      sex = as.factor(sex),
      island = as.factor(island)
    )

  # Remove species with insufficient sample sizes
  species_counts <- cleaned_data %>%
    dplyr::count(species) %>%
    dplyr::filter(n >= min_sample_size)

  result <- cleaned_data %>%
    dplyr::filter(species %in% species_counts$species)

  # Add metadata attributes
  attr(result, "sample_sizes") <- table(result$species)
  attr(result, "preparation_date") <- Sys.Date()

  return(result)
}

#' Get summary statistics by species
summarize_by_species <- function(data) {
  data %>%
    dplyr::group_by(species) %>%
    dplyr::summarise(
      n = dplyr::n(),
      bill_length_mean = mean(bill_length_mm, na.rm = TRUE),
      bill_length_sd = sd(bill_length_mm, na.rm = TRUE),
      bill_depth_mean = mean(bill_depth_mm, na.rm = TRUE),
      bill_depth_sd = sd(bill_depth_mm, na.rm = TRUE),
      body_mass_mean = mean(body_mass_g, na.rm = TRUE),
      body_mass_sd = sd(body_mass_g, na.rm = TRUE),
      .groups = "drop"
    )
}

#' Perform ANOVA comparing penguin species
analyze_species_differences <- function(data, response_var) {

  if (!requireNamespace("broom", quietly = TRUE)) {
    stop("broom package is required")
  }
  if (!requireNamespace("emmeans", quietly = TRUE)) {
    stop("emmeans package is required")
  }

  # Fit ANOVA model
  formula_str <- paste(response_var, "~ species")
  model <- aov(as.formula(formula_str), data = data)

  # ANOVA table
  anova_results <- broom::tidy(model)

  # Post-hoc comparisons
  emmeans_obj <- emmeans::emmeans(model, ~ species)
  pairwise <- emmeans::pairs(emmeans_obj, adjust = "tukey")

  # Effect sizes
  eta_squared <- anova_results$sumsq[1] / sum(anova_results$sumsq)

  list(
    model = model,
    anova_table = anova_results,
    posthoc_comparisons = broom::tidy(pairwise),
    eta_squared = eta_squared,
    sample_size = nrow(data)
  )
}

#' Create publication-ready species comparison plot
create_species_plot <- function(data, x_var, y_var, title = "") {

  if (!requireNamespace("ggplot2", quietly = TRUE)) {
    stop("ggplot2 package is required")
  }

  ggplot2::ggplot(data, ggplot2::aes_string(x = x_var, y = y_var)) +
    ggplot2::geom_boxplot(ggplot2::aes(fill = species), alpha = 0.7) +
    ggplot2::geom_jitter(ggplot2::aes(color = species),
                        width = 0.2, alpha = 0.5) +
    ggplot2::scale_fill_manual(
      values = c("Adelie" = "#FF6B6B",
                "Chinstrap" = "#4ECDC4",
                "Gentoo" = "#45B7D1")
    ) +
    ggplot2::scale_color_manual(
      values = c("Adelie" = "#FF6B6B",
                "Chinstrap" = "#4ECDC4",
                "Gentoo" = "#45B7D1")
    ) +
    ggplot2::labs(
      title = title,
      x = gsub("_", " ", tools::toTitleCase(gsub("_", " ", x_var))),
      y = gsub("_", " ", tools::toTitleCase(gsub("_", " ", y_var))),
      fill = "Species",
      color = "Species"
    ) +
    ggplot2::theme_classic() +
    ggplot2::theme(
      plot.title = ggplot2::element_text(hjust = 0.5, size = 12, face = "bold"),
      legend.position = "bottom",
      axis.text = ggplot2::element_text(size = 10),
      axis.title = ggplot2::element_text(size = 11)
    )
}

#' Create publication-ready ANOVA table
format_anova_table <- function(anova_result) {
  anova_result$anova_table %>%
    dplyr::mutate(
      df = df,
      `Sum Sq` = round(sumsq, 2),
      `Mean Sq` = round(meansq, 2),
      `F value` = round(statistic, 2),
      `Pr(>F)` = ifelse(p.value < 0.001, "< 0.001",
                       sprintf("%.3f", p.value))
    ) %>%
    dplyr::select(term, df, `Sum Sq`, `Mean Sq`, `F value`, `Pr(>F)`)
}
```

```{r load-data, include = FALSE}
# Load required packages
library(palmerpenguins)
library(dplyr)

# Prepare the data using our function
penguin_data <- prepare_penguin_data()

# Get summary statistics
summary_stats <- summarize_by_species(penguin_data)
```

# Introduction

Antarctic penguin species exhibit distinct morphological adaptations reflecting their ecological niches and evolutionary histories [@gorman2014ecological]. The Palmer penguins dataset provides morphological measurements from three species: Adelie (*Pygoscelis adeliae*), Chinstrap (*P. antarcticus*), and Gentoo (*P. papua*) penguins collected from islands in the Palmer Archipelago, Antarctica.

Understanding species-specific morphological patterns contributes to ecological and evolutionary theory while providing baseline data for conservation efforts. Previous studies have documented interspecific variation in penguin morphology [@fraser2019ecological], but comprehensive comparative analyses using standardized measurement protocols remain limited.

This study examines morphological differentiation among Palmer penguin species using statistical analysis of bill dimensions, flipper length, and body mass. We hypothesized that significant species differences would emerge across all morphological traits, reflecting distinct foraging strategies and habitat preferences.

# Methods

## Data and Study System

We analyzed morphological measurements from 333 penguins representing three species: Adelie (n = 146), Chinstrap (n = 68), and Gentoo (n = 119) collected between 2007-2009 in the Palmer Archipelago, Antarctica.

## Morphological Measurements

Four primary morphological variables were analyzed:
- Bill length (mm): distance from tip to base
- Bill depth (mm): height at base
- Flipper length (mm): length from body to tip
- Body mass (g): total body weight

## Statistical Analysis

Data preparation involved removing observations with missing values and calculating derived variables including bill ratio (length/depth) and body condition index (mass/flipper length). All analyses were conducted in R version `r R.version.string` using the ZZCOLLAB reproducible research framework.

Species differences were tested using one-way ANOVA for each morphological variable, with Tukey's HSD post-hoc tests for pairwise comparisons. Effect sizes were calculated using eta-squared ($\eta^2$). Statistical significance was set at Î± = 0.05.

```{r bill-length-analysis, echo = TRUE}
# Analyze bill length differences
cat("Creating bill length analysis...\n")
cat("penguin_data exists:", exists("penguin_data"), "\n")
if (exists("penguin_data")) {
  cat("penguin_data rows:", nrow(penguin_data), "\n")
}
bill_length_results <- analyze_species_differences(penguin_data, "bill_length_mm")
bill_length_table <- format_anova_table(bill_length_results)
cat("bill_length_results created successfully\n")
```

```{r body-mass-analysis, include = FALSE}
# Analyze body mass differences
body_mass_results <- analyze_species_differences(penguin_data, "body_mass_g")
body_mass_table <- format_anova_table(body_mass_results)
```

# Results

## Species Differences in Bill Length

Analysis revealed significant species differences in bill length (F(`r bill_length_results$anova_table$df[1]`, `r bill_length_results$anova_table$df[2]`) = `r round(bill_length_results$anova_table$statistic[1], 2)`, p < 0.001, $\eta^2$ = `r round(bill_length_results$eta_squared, 3)`).

```{r bill-length-table, echo = FALSE, results = "asis"}
apa_table(bill_length_table,
          caption = "ANOVA Results for Bill Length Differences Among Penguin Species",
          note = "df = degrees of freedom; Sum Sq = sum of squares; Mean Sq = mean squares")
```

Post-hoc comparisons indicated significant differences between all species pairs (all p < 0.001). Gentoo penguins exhibited the longest bills (M = `r round(summary_stats$bill_length_mean[summary_stats$species == "Gentoo"], 1)` mm, SD = `r round(summary_stats$bill_length_sd[summary_stats$species == "Gentoo"], 1)`), followed by Chinstrap (M = `r round(summary_stats$bill_length_mean[summary_stats$species == "Chinstrap"], 1)` mm, SD = `r round(summary_stats$bill_length_sd[summary_stats$species == "Chinstrap"], 1)`) and Adelie penguins (M = `r round(summary_stats$bill_length_mean[summary_stats$species == "Adelie"], 1)` mm, SD = `r round(summary_stats$bill_length_sd[summary_stats$species == "Adelie"], 1)`).

```{r bill-length-figure, fig.cap = "Bill length distributions among Palmer penguin species. Box plots show medians, quartiles, and individual data points.", echo = FALSE, fig.height = 4, fig.width = 6}
create_species_plot(penguin_data, "species", "bill_length_mm",
                   "Bill Length by Species")
```

## Species Differences in Body Mass

Body mass also differed significantly among species (F(`r body_mass_results$anova_table$df[1]`, `r body_mass_results$anova_table$df[2]`) = `r round(body_mass_results$anova_table$statistic[1], 2)`, p < 0.001, $\eta^2$ = `r round(body_mass_results$eta_squared, 3)`).

```{r body-mass-figure, fig.cap = "Body mass distributions among Palmer penguin species showing distinct size classes.", echo = FALSE, fig.height = 4, fig.width = 6}
create_species_plot(penguin_data, "species", "body_mass_g",
                   "Body Mass by Species")
```

Gentoo penguins were significantly heavier (M = `r round(summary_stats$body_mass_mean[summary_stats$species == "Gentoo"], 0)` g) than both Adelie (M = `r round(summary_stats$body_mass_mean[summary_stats$species == "Adelie"], 0)` g) and Chinstrap penguins (M = `r round(summary_stats$body_mass_mean[summary_stats$species == "Chinstrap"], 0)` g), while Adelie and Chinstrap species did not differ significantly in body mass (p = 0.067).

# Discussion

Our analysis demonstrates clear morphological differentiation among Palmer penguin species, with significant differences across all measured traits. These patterns likely reflect species-specific foraging strategies and ecological adaptations [@ainley2002adelie; @fraser2019ecological].

The large effect sizes observed ($\eta^2$ > 0.4 for all traits) indicate that morphological measurements provide reliable species discrimination criteria. Gentoo penguins' larger body size and longer bills may facilitate deeper diving and capture of larger prey items compared to Adelie and Chinstrap species [@wilson2001foraging].

## Conservation Implications

These morphological baseline data provide important reference points for monitoring population changes and potential evolutionary responses to environmental change. Climate-driven shifts in prey availability may differentially affect species based on their morphological adaptations [@trivelpiece2011variability].

## Limitations and Future Directions

Our analysis was limited to basic morphological measurements. Future studies should incorporate functional morphology assessments and examine relationships between morphology and foraging behavior. Additionally, temporal variation in morphological traits should be investigated using long-term datasets.

# Conclusions

Palmer penguin species exhibit significant morphological differentiation across all measured traits, supporting distinct evolutionary adaptations and ecological niches. These findings provide important baseline data for understanding Antarctic penguin ecology and monitoring responses to environmental change.

# References

```{r create-references, echo = FALSE, eval = FALSE}
r_refs(file = "references.bib")
```

\newpage

# Appendix

## Reproducibility Statement

All analyses were conducted using the ZZCOLLAB reproducible research framework. Analysis code, functions, and data processing scripts are available in the project repository. The complete computational environment is preserved using Docker containerization and renv package management.

## Statistical Software

Analyses were performed using R version `r R.version.string` with the following key packages: palmerpenguins v`r packageVersion("palmerpenguins")`, dplyr v`r packageVersion("dplyr")`, ggplot2 v`r packageVersion("ggplot2")`, and broom v`r packageVersion("broom")`.
```

**Create bibliography file:**

```bash
vim manuscript/references.bib
```

**Contents of `manuscript/references.bib`:**

```bibtex
@article{gorman2014ecological,
  title={Ecological sexual dimorphism and environmental variability within a community of Antarctic penguins (genus Pygoscelis)},
  author={Gorman, Kristen B and Williams, Tony D and Fraser, William R},
  journal={PLoS one},
  volume={9},
  number={3},
  pages={e90081},
  year={2014},
  publisher={Public Library of Science}
}

@article{fraser2019ecological,
  title={The ecological basis for inferring population trends of AdÃ©lie penguins from their prey},
  author={Fraser, William R and Patterson-Fraser, Donna L and Ribic, Christine A and Schofield, Oscar and Ducklow, Hugh and Hurwitz, Dana and Perovich, Donald and Gorman, Kristen B and Huettmann, Falk},
  journal={Integrative and Comparative Biology},
  volume={59},
  number={6},
  pages={1407--1416},
  year={2019},
  publisher={Oxford University Press}
}

@article{ainley2002adelie,
  title={The AdÃ©lie penguin: bellwether of climate change},
  author={Ainley, David},
  journal={Columbia University Press},
  year={2002}
}

@article{wilson2001foraging,
  title={Foraging behaviour of four sympatric penguin species at Ardley Island, Antarctica},
  author={Wilson, RP and Scolaro, JA and Peters, G and Laurenti, S and Kierspel, M and Gallelli, H and Upton, J},
  journal={Polar Biology},
  volume={24},
  number={8},
  pages={623--632},
  year={2001}
}

@article{trivelpiece2011variability,
  title={Variability in krill biomass links harvesting and climate warming to penguin population changes in Antarctica},
  author={Trivelpiece, Wayne Z and Hinke, Jefferson T and Miller, Aileen K and Reiss, Christian S and Trivelpiece, Susan G and Watters, George M},
  journal={Proceedings of the National Academy of Sciences},
  volume={108},
  number={18},
  pages={7625--7628},
  year={2011}
}
```

### Step 2: Create Reproducibility Scripts

**Create data preparation script:**

```bash
vim analysis/reproduce/01_data_preparation.R
```

**Contents of `analysis/reproduce/01_data_preparation.R`:**

```r
#' Data Preparation for Palmer Penguin Manuscript
#'
#' This script reproduces all data processing steps for the manuscript.
#' Run from project root directory.

cat("Starting data preparation...\n")

# Load required packages
library(palmerpenguins)
library(dplyr)

# Source our data processing functions
source("R/data_processing.R")

# Prepare the main dataset
penguin_data <- prepare_penguin_data()

cat("Data preparation completed:\n")
cat("- Total observations:", nrow(penguin_data), "\n")
cat("- Species counts:\n")
print(table(penguin_data$species))

# Generate summary statistics
summary_stats <- summarize_by_species(penguin_data)

cat("\nSummary statistics by species:\n")
print(summary_stats)

# Save processed data for manuscript
saveRDS(penguin_data, "data/derived_data/penguin_analysis_data.rds")
saveRDS(summary_stats, "data/derived_data/species_summary_stats.rds")

cat("\nProcessed data saved to data/derived_data/\n")
cat("Data preparation script completed successfully.\n")
```

**Create statistical analysis script:**

```bash
vim analysis/reproduce/02_statistical_analysis.R
```

**Contents of `analysis/reproduce/02_statistical_analysis.R`:**

```r
#' Statistical Analysis for Palmer Penguin Manuscript
#'
#' This script reproduces all statistical analyses reported in the manuscript.

cat("Starting statistical analysis...\n")

# Load required packages
library(dplyr)
library(broom)
library(emmeans)

# Source our analysis functions
source("R/statistical_analysis.R")

# Load processed data
penguin_data <- readRDS("data/derived_data/penguin_analysis_data.rds")

cat("Data loaded. Sample size:", nrow(penguin_data), "\n")

# Analysis 1: Bill length differences
cat("\n=== BILL LENGTH ANALYSIS ===\n")
bill_length_results <- analyze_species_differences(penguin_data, "bill_length_mm")

cat("ANOVA F-statistic:", round(bill_length_results$anova_table$statistic[1], 2), "\n")
cat("p-value:", format.pval(bill_length_results$anova_table$p.value[1], digits = 3), "\n")
cat("Effect size (eta-squared):", round(bill_length_results$eta_squared, 3), "\n")

# Post-hoc comparisons
cat("\nPost-hoc comparisons:\n")
print(bill_length_results$posthoc_comparisons)

# Analysis 2: Bill depth differences
cat("\n=== BILL DEPTH ANALYSIS ===\n")
bill_depth_results <- analyze_species_differences(penguin_data, "bill_depth_mm")

cat("ANOVA F-statistic:", round(bill_depth_results$anova_table$statistic[1], 2), "\n")
cat("p-value:", format.pval(bill_depth_results$anova_table$p.value[1], digits = 3), "\n")
cat("Effect size (eta-squared):", round(bill_depth_results$eta_squared, 3), "\n")

# Analysis 3: Body mass differences
cat("\n=== BODY MASS ANALYSIS ===\n")
body_mass_results <- analyze_species_differences(penguin_data, "body_mass_g")

cat("ANOVA F-statistic:", round(body_mass_results$anova_table$statistic[1], 2), "\n")
cat("p-value:", format.pval(body_mass_results$anova_table$p.value[1], digits = 3), "\n")
cat("Effect size (eta-squared):", round(body_mass_results$eta_squared, 3), "\n")

# Analysis 4: Flipper length differences
cat("\n=== FLIPPER LENGTH ANALYSIS ===\n")
flipper_results <- analyze_species_differences(penguin_data, "flipper_length_mm")

cat("ANOVA F-statistic:", round(flipper_results$anova_table$statistic[1], 2), "\n")
cat("p-value:", format.pval(flipper_results$anova_table$p.value[1], digits = 3), "\n")
cat("Effect size (eta-squared):", round(flipper_results$eta_squared, 3), "\n")

# Save all statistical results
results_list <- list(
  bill_length = bill_length_results,
  bill_depth = bill_depth_results,
  body_mass = body_mass_results,
  flipper_length = flipper_results
)

saveRDS(results_list, "data/derived_data/statistical_results.rds")

cat("\nStatistical results saved to data/derived_data/statistical_results.rds\n")
cat("Statistical analysis completed successfully.\n")
```

**Create figures and tables script:**

```bash
vim analysis/reproduce/03_figures_tables.R
```

**Contents of `analysis/reproduce/03_figures_tables.R`:**

```r
#' Generate All Figures and Tables for Manuscript
#'
#' This script creates all figures and tables used in the manuscript.

cat("Generating manuscript figures and tables...\n")

# Load required packages
library(ggplot2)
library(dplyr)

# Source visualization functions
source("R/visualization.R")

# Load data and results
penguin_data <- readRDS("data/derived_data/penguin_analysis_data.rds")
statistical_results <- readRDS("data/derived_data/statistical_results.rds")

# Create directories for outputs
dir.create("submission/figures", recursive = TRUE, showWarnings = FALSE)
dir.create("submission/tables", recursive = TRUE, showWarnings = FALSE)

# Figure 1: Bill length comparison
cat("Creating Figure 1: Bill length by species...\n")
fig1 <- create_species_plot(penguin_data, "species", "bill_length_mm",
                           "Bill Length by Species")

ggsave("submission/figures/figure1_bill_length.png", fig1,
       width = 6, height = 4, dpi = 300)
ggsave("submission/figures/figure1_bill_length.pdf", fig1,
       width = 6, height = 4)

# Figure 2: Body mass comparison
cat("Creating Figure 2: Body mass by species...\n")
fig2 <- create_species_plot(penguin_data, "species", "body_mass_g",
                           "Body Mass by Species")

ggsave("submission/figures/figure2_body_mass.png", fig2,
       width = 6, height = 4, dpi = 300)
ggsave("submission/figures/figure2_body_mass.pdf", fig2,
       width = 6, height = 4)

# Figure 3: Bill depth comparison
cat("Creating Figure 3: Bill depth by species...\n")
fig3 <- create_species_plot(penguin_data, "species", "bill_depth_mm",
                           "Bill Depth by Species")

ggsave("submission/figures/figure3_bill_depth.png", fig3,
       width = 6, height = 4, dpi = 300)

# Figure 4: Flipper length comparison
cat("Creating Figure 4: Flipper length by species...\n")
fig4 <- create_species_plot(penguin_data, "species", "flipper_length_mm",
                           "Flipper Length by Species")

ggsave("submission/figures/figure4_flipper_length.png", fig4,
       width = 6, height = 4, dpi = 300)

# Create publication-ready tables
cat("Creating ANOVA tables...\n")

# Table 1: Bill length ANOVA
bill_length_table <- format_anova_table(statistical_results$bill_length)
write.csv(bill_length_table, "submission/tables/table1_bill_length_anova.csv",
          row.names = FALSE)

# Table 2: Body mass ANOVA
body_mass_table <- format_anova_table(statistical_results$body_mass)
write.csv(body_mass_table, "submission/tables/table2_body_mass_anova.csv",
          row.names = FALSE)

# Table 3: Summary statistics table
summary_stats <- summarize_by_species(penguin_data)
write.csv(summary_stats, "submission/tables/table3_summary_statistics.csv",
          row.names = FALSE)

cat("All figures saved to submission/figures/\n")
cat("All tables saved to submission/tables/\n")
cat("Figure and table generation completed successfully.\n")
```

### Step 3: Test Functions and Run Analysis

**Inside the container:**

```bash
# Install required packages for manuscript
R
install.packages(c("palmerpenguins", "dplyr", "ggplot2", "broom",
                  "emmeans", "papaja", "corrplot", "stringr"))
quit()

# Test all functions
R
devtools::load_all()
devtools::test()
quit()

# Create output directories
mkdir -p data/derived_data
mkdir -p submission/figures
mkdir -p submission/tables

# Run complete reproducibility workflow
R --vanilla < analysis/reproduce/01_data_preparation.R
R --vanilla < analysis/reproduce/02_statistical_analysis.R
R --vanilla < analysis/reproduce/03_figures_tables.R

# Render the manuscript
R
rmarkdown::render("manuscript/paper.Rmd")
quit()

# Check outputs
ls -la manuscript/
ls -la submission/figures/
ls -la submission/tables/
```

### Step 4: Commit Manuscript

```bash
# Exit container
exit

# Validate complete workflow
make docker-check-renv-fix    # Update dependencies
make docker-test             # Run all tests
make docker-render           # Ensure manuscript compiles

# Git workflow
git add .
git commit -m "Complete Palmer penguin species comparison manuscript

- Implement data processing functions with comprehensive tests
- Add statistical analysis functions (ANOVA, post-hoc tests)
- Create publication-ready visualization functions
- Write complete manuscript in papaja format
- Add reproducibility scripts for all analyses
- Generate all figures and tables for submission
- Include comprehensive bibliography and citations
- All tests passing, manuscript renders successfully"

git push origin main
```

## Team Collaboration in Manuscript Paradigm

The research compendium structure enables effective team collaboration on both R functions and manuscript content.

### Team Roles and Workflows

#### **Role 1: Statistician/Methods Developer**
Focus on R function development and statistical analysis:

```bash
# Statistician workflow - focus on R functions
git checkout -b feature/survival-analysis

# Develop new statistical methods
vim R/survival_models.R
vim tests/testthat/test-survival_models.R

# Test and validate new functions
make docker-zsh
R
devtools::load_all()
devtools::test()
devtools::document()
quit()

# Commit statistical contributions
git add R/ tests/ man/
git commit -m "Add survival analysis functions

- Implement Cox proportional hazards models
- Add model validation and diagnostics functions
- Include comprehensive test suite
- Update NAMESPACE with new exports"

git push origin feature/survival-analysis
```

#### **Role 2: Domain Expert/Writer**
Focus on manuscript content and biological interpretation:

```bash
# Domain expert workflow - focus on manuscript
git checkout -b manuscript/discussion-expansion

# Write and revise manuscript content
vim manuscript/paper.Rmd          # Update methods and discussion
vim manuscript/references.bib     # Add relevant citations

# Use updated analysis functions automatically
make docker-rstudio              # Access all team functions
# Functions from statistician are immediately available

# Render updated manuscript
R
rmarkdown::render("manuscript/paper.Rmd")
quit()

# Commit manuscript contributions
git add manuscript/
git commit -m "Expand discussion section

- Add biological interpretation of survival analysis
- Include references to recent ecological studies
- Update figures with survival model results
- Revise abstract to reflect new methods"

git push origin manuscript/discussion-expansion
```

#### **Role 3: Data Analyst/Reproducibility Specialist**
Focus on reproducibility scripts and validation:

```bash
# Data analyst workflow - focus on reproducibility
git checkout -b reproducibility/workflow-validation

# Update reproducibility pipeline
vim analysis/reproduce/01_data_preparation.R
vim analysis/reproduce/02_statistical_analysis.R  # Include new survival models
vim analysis/reproduce/03_figures_tables.R
vim analysis/reproduce/04_manuscript_render.R

# Validate complete workflow
make docker-test                 # Test all functions
R --vanilla < analysis/reproduce/01_data_preparation.R
R --vanilla < analysis/reproduce/02_statistical_analysis.R
R --vanilla < analysis/reproduce/03_figures_tables.R
R --vanilla < analysis/reproduce/04_manuscript_render.R

# Commit reproducibility improvements
git add analysis/reproduce/
git commit -m "Update reproducibility pipeline

- Integrate survival analysis into workflow
- Add validation checks for all data processing steps
- Generate complete figure and table set
- Ensure manuscript renders with all updates"

git push origin reproducibility/workflow-validation
```

### Integration and Review Process

```bash
# Team lead merges contributions
git checkout main

# Merge statistical functions first
git merge feature/survival-analysis
make docker-test                 # Validate all tests pass

# Merge manuscript updates
git merge manuscript/discussion-expansion
make docker-render               # Ensure manuscript compiles

# Merge reproducibility updates
git merge reproducibility/workflow-validation
make docker-full-build           # Complete validation

# Final team review
git push origin main
```

### Collaborative Development Commands

```bash
# Team member joining existing manuscript project
git clone https://github.com/teamname/manuscript-project.git
cd manuscript-project

# Set up development environment with all team functions
make docker-rstudio              # All team functions available immediately

# Inside container - access all team contributions
R
devtools::load_all()             # Load all functions from R/
library(penguinanalysis)         # Use as installed package
help(package="penguinanalysis")  # See all team functions
quit()

# Create feature branch for your contribution
git checkout -b your-contribution-name
# Work on your part (R functions OR manuscript content OR reproducibility)
# Commit and push your changes
```

### Team Communication Workflow

**Daily Sync Pattern:**
1. **Morning**: Pull latest changes, load all team functions
2. **Development**: Work on your specialized area (functions/manuscript/reproducibility)
3. **Integration**: Test your changes with latest team functions
4. **Evening**: Push changes, communicate progress

**Integration Points:**
- **R functions**: Immediately available to all team members through `devtools::load_all()`
- **Manuscript**: Uses all latest functions automatically when rendering
- **Tests**: Validate all functions work correctly together
- **Reproducibility**: Ensures complete workflow remains functional

## Benefits of Manuscript Paradigm

- **Publication-Ready Structure**: Direct path from analysis to submitted manuscript
- **Reproducibility**: Complete workflow captured in version control
- **Professional Quality**: LaTeX formatting, proper citations, statistical tables
- **Collaboration Ready**: Functions tested and documented for team use
- **Submission Package**: Automatically generates journal-ready figures and tables
- **Version Control**: Track manuscript changes alongside analysis evolution
- **Validation**: Automated testing ensures analysis functions work correctly
- **Reusability**: Functions can be reused for other manuscripts or projects

## Manuscript Paradigm vs Analysis Paradigm

**Manuscript Paradigm**:
- Focus: Academic publication preparation
- Structure: `R/`, `tests/`, `manuscript/`, `analysis/reproduce/`, `submission/`
- Output: PDF manuscript, supplementary materials, submission package
- Tools: papaja, bookdown, LaTeX, RefManageR, journals-specific templates

**Analysis Paradigm**:
- Focus: Data exploration and insight generation
- Structure: `data/`, `analysis/`, `outputs/figures/`, `reports/`, `scripts/`
- Output: Reports, dashboards, presentations
- Tools: tidyverse, targets, plotly, flexdashboard

The manuscript paradigm is optimized for the academic publication pipeline, ensuring reproducible research meets journal submission requirements.

## Integrated Development Commands

The research compendium structure provides specialized commands for both R package development and manuscript preparation:

### R Package Development Commands

```bash
# R function development and validation
make docker-test              # Run all function tests
make docker-check             # R CMD check validation
make docker-document          # Generate function documentation
make docker-build             # Build R package
make docker-install           # Install package locally

# Function-specific development
make docker-zsh
R
devtools::load_all()          # Load all functions for interactive development
devtools::test()              # Run test suite
devtools::check()             # Full package validation
devtools::document()          # Update documentation
usethis::use_test("new_function")  # Create test file
quit()
```

### Manuscript Development Commands

```bash
# Manuscript rendering and validation
make docker-render            # Render all manuscript formats
make docker-publish           # Generate submission package
make docker-latex             # LaTeX compilation and formatting

# Manuscript-specific development
make docker-rstudio          # RStudio for interactive writing
# Inside RStudio:
# - Edit manuscript/paper.Rmd
# - Preview with Knit button
# - Use all R functions interactively

make docker-verse            # Advanced LaTeX and publishing tools
```

### Integrated Workflow Commands

```bash
# Complete development and validation workflow
make docker-full-build       # Test R functions + render manuscripts + validate workflow
make docker-repro-check      # Run complete reproducibility validation
make docker-submit-prep      # Prepare complete submission package

# Continuous integration workflow
make docker-ci-test          # Run all tests suitable for CI/CD
make docker-ci-build         # Complete CI/CD validation pipeline
```

### Development Environment Commands

```bash
# Environment management
make docker-clean            # Clean development environment
make docker-rebuild          # Rebuild from scratch
make docker-update           # Update all dependencies

# Specialized environments
make docker-stats            # Environment optimized for statistical development
make docker-writing          # Environment optimized for manuscript writing
make docker-repro            # Environment for reproducibility validation
```

### Custom Development Workflows

```bash
# Daily development cycle
make daily-dev               # Load environment + run tests + render manuscript
make daily-commit           # Validate + commit + push changes
make daily-sync             # Pull updates + rebuild + validate

# Team synchronization
make team-sync              # Pull all changes + validate integration
make team-validate          # Run complete team validation suite
make team-release           # Prepare release candidate
```

### Example Integrated Development Session

```bash
# Morning: Start development session
cd manuscript-project
make docker-rstudio         # Start integrated environment

# Inside RStudio/Container:
# 1. Modify R functions (automatically loaded)
# 2. Update tests for modified functions
# 3. Write/edit manuscript content
# 4. Preview manuscript with updated functions
# 5. Validate complete workflow

# Evening: Validate and commit
make docker-full-build      # Complete validation
make daily-commit           # Commit all changes

# Team integration
make team-sync             # Sync with team contributions
make team-validate         # Ensure all team functions work together
```

## Advanced Manuscript Features

### Multiple Document Types

```bash
# Create different manuscript formats
vim manuscript/preprint.Rmd        # Preprint version
vim manuscript/journal_version.Rmd # Journal-specific formatting
vim manuscript/presentation.Rmd    # Conference presentation
vim manuscript/poster.Rmd          # Academic poster
```

### Supplementary Materials

```bash
# Comprehensive supplementary materials
vim manuscript/supplementary.Rmd   # Supplementary methods and results
vim manuscript/appendix.Rmd        # Additional analyses
vim manuscript/code_supplement.Rmd # Annotated analysis code
```

### Journal-Specific Templates

```r
# In manuscript YAML header, specify journal templates:
output:
  papaja::apa6_pdf          # APA format
  rticles::elsevier_article # Elsevier journals
  rticles::plos_article     # PLOS journals
  bookdown::pdf_document2   # General academic format
```

This manuscript-focused workflow ensures academic research meets publication standards while maintaining full reproducibility through the ZZCOLLAB framework.